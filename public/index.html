<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Curadoria de Imagens BNCC - Computa√ß√£o</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üé®</text></svg>">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üé® Curadoria de Imagens BNCC - Computa√ß√£o</h1>
            <p>Sistema de aprova√ß√£o e gerenciamento de imagens did√°ticas</p>
        </div>

        <div class="content">
            <div id="status"></div>
            
            <div id="rowInfo" style="display: none;">
                <div class="row-info">
                    <div class="activity-header">
                        <h3>üìö Informa√ß√µes da Atividade</h3>
                        <div class="inline-navigation">
                            <button class="btn btn-primary btn-compact" onclick="previousRow()" id="prevBtn">‚¨ÖÔ∏è Anterior</button>
                            <div class="progress-compact">
                                <span><span id="currentRow">0</span> de <span id="totalRows">0</span></span>
                                <div class="progress-bar" style="width: 120px; height: 6px; background: #e9ecef; border-radius: 3px; overflow: hidden; margin: 0 10px;">
                                    <div id="progressFill" style="height: 100%; background: #007bff; width: 0%; transition: width 0.3s ease;"></div>
                                </div>
                            </div>
                            <div class="goto-line">
                                <input type="number" id="gotoLineInput" placeholder="Ir para linha" min="1" max="1">
                                <button class="btn btn-secondary btn-compact" onclick="gotoLine()" id="gotoBtn">Ir</button>
                            </div>
                            <button class="btn btn-primary btn-compact" onclick="nextRow()" id="nextBtn">Pr√≥ximo ‚û°Ô∏è</button>
                        </div>
                    </div>
                    <p><strong>Etapa:</strong> <span id="step"></span></p>
                    <p><strong>Eixo:</strong> <span id="axes"></span></p>
                    <p><strong>Descri√ß√£o:</strong> <span id="description"></span></p>
                    <p><strong>Habilidade Superior:</strong> <span id="skill"></span></p>
                    <p><strong>Explica√ß√£o:</strong> <span id="explanation"></span></p>
                    <p><strong>Exemplos:</strong> <span id="examples"></span></p>
                </div>
            </div>
            
            <div id="navigation" class="navigation" style="display: none;">
            </div>
            
            <div id="imageSection" class="image-section" style="display: none; max-width: 1400px; margin: 0 auto; padding: 20px; width: 98%;">
                <div id="quotaError" class="quota-error" style="display: none;">
                    <div class="error-message">
                        ‚ö†Ô∏è USO DI√ÅRIO DA GERA√á√ÉO DE IA EXPIRADO - TENTE NOVAMENTE AMANH√É
                    </div>
                </div>
                
                <div class="two-column-layout">
                    <div class="left-column">
                        <div class="current-image-section">
                            <h4>üì∑ Imagem Atual</h4>
                            <div id="existingUrlWarning" class="existing-url-warning" style="display: none;">
                                ‚ö†Ô∏è <strong>Aten√ß√£o:</strong> Esta atividade j√° possui uma imagem salva. Gerar uma nova imagem ir√° sobrescrever a existente se aprovada.
                            </div>
                            <div class="image-container" id="currentImageContainer">
                                <div id="noCurrentImage" class="no-image-message">
                                    <div class="no-image-icon">üñºÔ∏è</div>
                                    <p>N√£o existe ainda uma imagem para essa atividade.</p>
                                    <br><p>(Clique em GERAR IMAGEM na se√ß√£o ao lado)</p>
                                </div>
                                <div id="existingImageSection" style="display: none;">
                                    <img id="existingImage" src="" alt="Imagem atual" class="clickable-image" onclick="openImagePopup(this.src, 'Imagem Atual')">
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="right-column">
                        <div class="new-image-section">
                            <h4>üé® Nova Imagem</h4>
                            
                            <div class="custom-prompt-section">
                                <div class="prompt-toggle" onclick="togglePromptSection()">
                                    <span class="toggle-icon" id="promptToggleIcon">‚ñ∂Ô∏è</span>
                                    <span class="toggle-text">‚úèÔ∏è Prompt Personalizado (opcional)</span>
                                </div>
                                <div class="prompt-content" id="promptContent" style="display: none;">
                                    <textarea id="customPrompt1" placeholder="Digite aqui ideias adicionais para a imagem (ex: 'com foco em animais', 'estilo cartoon', 'ambiente ao ar livre')... Isso ser√° combinado com as descri√ß√µes educacionais autom√°ticas."></textarea>
                                    <div class="prompt-actions">
                                        <button class="btn btn-secondary btn-small" onclick="clearCustomPrompt()">üóëÔ∏è Limpar</button>
                                    </div>
                                    <small>üí° Dica: O prompt personalizado ser√° **adicionado** √†s descri√ß√µes autom√°ticas, dando foco especial √† sua ideia mas preservando todo o conte√∫do educacional</small>
                                </div>
                            </div>
                            
                            <div class="generate-action">
                                <button class="btn btn-primary btn-generate" id="generateBtn1" onclick="generateImage(1)">üé® Gerar Imagem</button>
                            </div>
                            
                            <div class="image-navigation" id="imageNavigation" style="display: none;">
                                <div class="nav-info">
                                    <span id="imagePosition">Imagem 1 de 1</span>
                                </div>
                                <div class="nav-buttons">
                                    <button class="btn btn-secondary btn-small" id="prevImageBtn" onclick="showPreviousImage()" disabled>‚¨ÖÔ∏è Anterior</button>
                                    <button class="btn btn-secondary btn-small" id="nextImageBtn" onclick="showNextImage()" disabled>Pr√≥xima ‚û°Ô∏è</button>
                                </div>
                            </div>

                            <div class="image-container" id="newImageContainer">
                                <img id="imagePreview1" src="" alt="Pr√©via da nova imagem" class="clickable-image" onclick="openImagePopup(this.src, 'Nova Imagem Gerada')" style="display: none;">
                            </div>
                            
                            <div class="approval-actions">
                                <button class="btn btn-success" id="approveBtn1" onclick="approveImage(1)" disabled>‚úÖ Aprovar Nova</button>
                                <button class="btn btn-danger" id="rejectBtn1" onclick="rejectImage(1)" disabled>‚ùå Reprovar Nova</button>
                            </div>
                            
                            <div id="imageStatus1" class="image-status-external">Nenhuma imagem gerada</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="imagePopup" class="image-popup" onclick="closeImagePopup()">
        <span class="image-popup-close" onclick="closeImagePopup()">&times;</span>
        <div class="image-popup-content">
            <img id="popupImage" src="" alt="Imagem em tamanho completo">
            <div id="popupTitle" class="image-popup-title"></div>
        </div>
    </div>

    <script src="app.js"></script>
    <script>
        function openImagePopup(imageSrc, title) {
            if (!imageSrc || imageSrc === '') {
                alert('Nenhuma imagem dispon√≠vel para visualizar.');
                return;
            }
            
            const popup = document.getElementById('imagePopup');
            const popupImage = document.getElementById('popupImage');
            const popupTitle = document.getElementById('popupTitle');
            
            popupImage.src = imageSrc;
            popupTitle.textContent = title || 'Imagem';
            popup.style.display = 'block';
            
            document.body.style.overflow = 'hidden';
        }
        
        function closeImagePopup() {
            const popup = document.getElementById('imagePopup');
            popup.style.display = 'none';
            
            document.body.style.overflow = 'auto';
        }
        
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                closeImagePopup();
            }
        });
        
        document.getElementById('popupImage').addEventListener('click', function(event) {
            event.stopPropagation();
        });
        
   
        function clearCustomPrompt() {
            document.getElementById('customPrompt1').value = '';
        }
        
        function togglePromptSection() {
            const content = document.getElementById('promptContent');
            const icon = document.getElementById('promptToggleIcon');
            
            if (content.style.display === 'none') {
                content.style.display = 'block';
                icon.textContent = 'üîΩ';
                icon.classList.add('expanded');
            } else {
                content.style.display = 'none';
                icon.textContent = '‚ñ∂Ô∏è';
                icon.classList.remove('expanded');
            }
        }
    </script>
</body>
</html>